## 实验室的软件框架是什么？

-   对底层接口进行封装与模块化；屏蔽繁琐的底层代码，露出简单易用的接口函数

-   通过操作系统freeRTOS，对各种线程任务实行抢占式调度（分时调度--时间片、抢占式调度--优先级）

-   上层：控制、导航、轨迹规划算法

-   比如说：屏蔽与传感器底层的寄存器打交道的函数，露出得到传感器数据的接口函数，这些值作为反馈值，传入串极-前馈PID控制环，用于对上层轨迹规划的控制。

## 介绍一下实验室用到的多线程之间的通信

-   实验室用的操作系统是FreeRTOS操作系统，在这个操作系统上进行进程间通信一般用的是消息队列。我维护了一个深度为1的消息队列，写方式用overwrite方式，即覆盖方式，读方式用peek方式，即复制方式。
-   这样做的原因：我们的很多数据都会被重复使用，比如说，传感器IMU将采集到的数据送入消息队列中，之后的姿态解算、控制都需要用到IMU数据，如果用一般数据出队函数pop函数，那么会第一个拿到该数据的线程外的其他线程拿不到该数据。我就设计了将读模式改成了peek，是复制而不是pop。至于写用overwrite，由于我们每次只需要拿到传感器最新的数据，其他的旧的数据不予理会，因此直接覆盖即可。

## 介绍一下实验室用到的多线程之间的同步

-   利用信号量来实现同步。
-   我们设了几个线程，分别是5ms执行一次（传感器值的获取）、10ms执行一次（控制）、50ms执行一次（地面站下传），那么如何保证线程间有顺序的、周期性的工作来保证整个进程的稳定运作呢？我们写了一个判断函数，检查当前计数器的值，当现在计数器的值为5的倍数时，执行线程1，用来获取传感器的值，当为10的倍数时，执行线程2，用来飞行控制，当为50的倍数时，执行线程3，用来将数据下传到地面站上。

## 传感器对于无人机来说是否很重要？

-   重要。之前换的是普通GPS，用EKF解算姿态，但是精度还是不高，在+-1m左右；换了更高精度的RTK，即使用互补滤波，精度也能够达到厘米级别，让整个飞机的控制上升了一个档次。再比如说发动机控速，之前发动机测速传感器有噪声，测量的转速值会有突变；软件的解决方案是利用滤波限幅，当前后两值超过一定限度时，说明这次的传感器值不准确，当更换了更准确的发动机测速传感器时，不需要滤波也能够稳定控速。

## 你在这一年多的时间里学到了什么？

## FreeRTOS与linux有什么区别？

## 如果你写的线程导致进程崩溃会怎么样？

## 解释一下什么叫做交叉编译？底层用的什么编译器？