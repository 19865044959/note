## 实验室的软件框架是什么？

-   对底层接口进行封装与模块化；屏蔽繁琐的底层代码，露出简单易用的接口函数

-   通过操作系统freeRTOS，对各种线程任务实行抢占式调度（分时调度--时间片、抢占式调度--优先级）

-   上层：控制、导航、轨迹规划算法

-   比如说：屏蔽与传感器底层的寄存器打交道的函数，露出得到传感器数据的接口函数，这些值作为反馈值，传入串极-前馈PID控制环，用于对上层轨迹规划的控制。

## 介绍一下实验室用到的多线程之间的通信

-   实验室用的操作系统是FreeRTOS操作系统，在这个操作系统上进行进程间通信一般用的是消息队列。我维护了一个**深度为1的消息队列**，写方式用overwrite方式，即覆盖方式，读方式用peek方式，即复制方式。
-   理解深度为1：
    -   即一个队列里面只有一个struct，struct里面包含pos[3]、v[3]、acc[3]、gyro[3]等，这个单元大小可以由程序员灵活调整
-   存入：
    -   加速度与角速度信息送到消息队列中（200HZ）
    -   GPS与磁力计数据送到消息队列中（200HZ）
-   获取：
    -   导航：
        -   获取姿态解算（200HZ）需要用到的加速度与磁力计信息
        -   获取GPS + INS EKF融合需要用到的用到的LLH与Vx Vy信息
    -   控制：
        -   角速度wx wy wz
-   这样做的原因：我们的很多数据都会被重复使用，比如说，传感器IMU将采集到的数据送入消息队列中，之后的导航、控制都需要用到IMU数据，如果用一般数据出队函数pop函数，那么会第一个拿到该数据的线程外的其他线程拿不到该数据。我就设计了将读模式改成了peek，是复制而不是pop。至于写用overwrite，由于我们每次只需要拿到传感器最新的数据，其他的旧的数据不予理会，因此直接覆盖即可。

## 介绍一下实验室用到的多线程之间的同步

-   利用信号量来实现同步。
-   我们设了几个线程，分别是200Hz（传感器值的获取）、100Hz（控制）、20Hz（地面站下传），那么如何保证线程间有顺序的、周期性的工作来保证整个进程的稳定运作呢？我们写了一个判断函数，检查当前计数器的值，当现在计数器的值为5的倍数时，执行线程1，用来获取传感器的值，当为10的倍数时，执行线程2，用来飞行控制，当为50的倍数时，执行线程3，用来将数据下传到地面站上。

## 传感器对于无人机来说是否很重要？

-   重要。之前换的是普通GPS，用EKF解算姿态，但是精度还是不高，在+-1m左右；换了更高精度的RTK，即使用互补滤波，精度也能够达到厘米级别，让整个飞机的控制上升了一个档次。再比如说发动机控速，之前发动机测速传感器有噪声，测量的转速值会有突变；软件的解决方案是利用滤波限幅，当前后两值超过一定限度时，说明这次的传感器值不准确，当更换了更准确的发动机测速传感器时，不需要滤波也能够稳定控速。

## 你在这一年多的时间里学到了什么？

-   debug：通过现象来分析问题出现点的能力。软件的debug就不说了，综合上，通过无人机飞行出现的异象来分析无人机到底是哪方面出问题：

    -   传感器测量出现问题：拿回传感器的原始数据，利用matlab作图分析

    -   硬件结构出现问题，比如连接线接触不良

    -   干扰问题：比如磁场干扰（磁力计）、温漂（气压计）、地线未屏蔽（信号会出现毛刺）干扰

    -   软件算法出现问题：debug模式

-   技术：

    -   硬件选型（传感器选型）、检查

    -   软件：

        -   底层：控制算法（PID）、导航算法

        -   上层：路径规划算法

## FreeRTOS与linux有什么区别？

-   FreeRTOS是实时操作系统，而linux是分时操作系统

## 如果你写的线程导致进程崩溃会怎么样？



## 为什么想来蔚来？小鹏不是也很好吗？

-   身边师兄都推荐我去蔚来，说蔚来技术强，待遇好
-   牛客网上宣传，蔚来的培养体系（蔚来应届生培养），菁英实习生有转正答辩，还有很多应届生offer比较，比如说华为、蔚来之类的比较，都会选择蔚来多一些，我认为这也从侧面上证明了蔚来的发展实力
-   不可否认，蔚来的福利待遇比较好，在牛客上比较了很多，还有期权拿

## 为什么转身开发，而不是算法？

-   只是实现，没有优化，个人认为同比与那些发过paper的人相比，竞争力不足

## 你对我们部门有什么了解？你最感兴趣的是哪一方面？

-   AI平台 - 高级软件工程师 
    岗位职责： 
    - 参与设计和开发自动驾驶研发工具链 
    - 参与设计和研发自动驾驶系统模块评测引擎和大规模评测系统 
    - 参与设计和研发自动驾驶车端数据存储、分析处理和回传系统 
    - 参与设计和研发自动驾驶数据分布式计算平台 
    基本要求： 
    - 计算机或者相关专业，本科或以上学历 
    - 熟练掌握 Golang / Python / C++ / JAVA 至少一门编程语言 
    - 优秀的沟通协作能力、分析解决问题能力和学习能力 
    加分项： 
    - 有分布式的软件架构设计、开发经验 
    - 有自动驾驶领域背景 
    - 熟悉 AWS / Azure / 阿里云 / 腾讯云 等云服务 
    - 对某一领域有深入研究，如存储，计算，大型系统设计等
-   工具链，代码管理，CICD，编译，发布，测试相关的东西
-   自动驾驶系统评测引擎：感知、定位模块效果进行评测：上百万公里的数据评测
-   自动驾驶数据最后会存储到车上，对这些数据做分析，感兴趣的数据回传到服务器，数据给其他部门

## 你为什么会投“自动驾驶AI软件开发暑期实习生”？

-   其实很简单，就是我主要做无人机的，又想搞开发，我想着自动驾驶软件开发可能会更契合我做的东西
-   我对这方面也是很感兴趣的
-   自动驾驶这方面非常有前景，朝阳产业

## 你有没有什么想问我的？

-   很想留在蔚来，那么转正答辩是怎样的？如果我有转正答辩会不会交给我的任务会更有挑战一些？
-   暑期实习的待遇/补贴我是直接问HR就行了是吧？
-   正式员工一般的工作时长的多久？
-   进来是会有一个培训吗？还是说一进来就要干活呢？



